<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Google Site Verification -->
<meta name="google-site-verification" content="BrjL5fpoyHZu1rR8rwnnM2MBO3u3iIFB8NsmSuOsY84" />
<title>Benchmark Multiple Learners on Multiple Tasks — benchmark • mlr3</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  <link href="../extra.css" rel="stylesheet">
  <script src="../extra.js"></script>
<meta property="og:title" content="Benchmark Multiple Learners on Multiple Tasks — benchmark" />

<meta property="og:description" content="Runs a benchmark on arbitrary combinations of learners, tasks, and resampling strategies (possibly in parallel).
Resamplings which are not already instantiated will be instantiated automatically.
However, these auto-instantiated resamplings will not be synchronized per task, i.e. different learners will
work on different splits of the same task.
To generate exhaustive designs and automatically instantiate resampling strategies per task, use benchmark_grid()." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




<link rel="icon" type="image/png" href="https://mlr-org.github.io/mlr/favicon.ico">
<link rel="apple-touch-icon" type="image/png" href="https://mlr-org.github.io/mlr/favicon.ico">
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html"></a>
      </div>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mlr-org/mlr3">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.slack.com">
    <span class="fa fa-slack"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/questions/tagged/mlr3">
    <span class="fa fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.com/">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Benchmark Multiple Learners on Multiple Tasks</h1>
    <small>Source: <a href='https://github.com/mlr-org/mlr3/blob/master/R/benchmark.R'><code>R/benchmark.R</code></a></small>
    </div>

    
    <p>Runs a benchmark on arbitrary combinations of learners, tasks, and resampling strategies (possibly in parallel).
Resamplings which are not already instantiated will be instantiated automatically.
However, these auto-instantiated resamplings will not be synchronized per task, i.e. different learners will
work on different splits of the same task.</p>
<p>To generate exhaustive designs and automatically instantiate resampling strategies per task, use <code><a href='benchmark_grid.html'>benchmark_grid()</a></code>.</p>
    

    <pre class="usage"><span class='fu'>benchmark</span>(<span class='no'>design</span>, <span class='kw'>store_models</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>design</th>
      <td><p>:: <code><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame()</a></code><br />
Data frame (or <code><a href='https://www.rdocumentation.org/packages/data.table/topics/data.table'>data.table::data.table()</a></code>) with three columns: "task", "learner", and "resampling".
Each row defines a resampling by providing a <a href='Task.html'>Task</a>, <a href='Learner.html'>Learner</a> and a <a href='Resampling.html'>Resampling</a> strategy.
All resamplings must be properly instantiated.
The helper function <code><a href='benchmark_grid.html'>benchmark_grid()</a></code> can assist in generating an exhaustive design (see examples) and
instantiate the <a href='Resampling.html'>Resampling</a>s per <a href='Task.html'>Task</a>.</p></td>
    </tr>
    <tr>
      <th>store_models</th>
      <td><p>:: <code><a href='https://www.rdocumentation.org/packages/base/topics/logical'>logical(1)</a></code><br />
Keep the fitted model after the test set has been predicted?
Set to <code>TRUE</code> if you want to further analyse the models or want to
extract information like variable importance.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><a href='BenchmarkResult.html'>BenchmarkResult</a>.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The fitted models are discarded after the predictions have been scored in order to reduce memory consumption.
If you need access to the models for later analysis, set <code>store_models</code> to <code>TRUE</code>.</p>
    
    <h2 class="hasAnchor" id="parallelization"><a class="anchor" href="#parallelization"></a>Parallelization</h2>

    
    <p>This function can be parallelized with the <a href='https://CRAN.R-project.org/package=future'><span class="pkg">future</span></a> package.
One job is one resampling iteration, and all jobs are send to an apply function
from <a href='https://CRAN.R-project.org/package=future.apply'><span class="pkg">future.apply</span></a> in a single batch.
To select a parallel backend, use <code><a href='https://www.rdocumentation.org/packages/future/topics/plan'>future::plan()</a></code>.</p>
    
    <h2 class="hasAnchor" id="logging"><a class="anchor" href="#logging"></a>Logging</h2>

    
    <p>The <a href='https://CRAN.R-project.org/package=mlr3'><span class="pkg">mlr3</span></a> uses the <a href='https://CRAN.R-project.org/package=lgr'><span class="pkg">lgr</span></a> package for logging.
<a href='https://CRAN.R-project.org/package=lgr'><span class="pkg">lgr</span></a> supports multiple log levels which can be queried with
<code><a href='https://www.rdocumentation.org/packages/base/topics/options'>getOption("lgr.log_levels")</a></code>.</p>
<p>To suppress output and reduce verbosity, you can lower the log from the
default level <code>"info"</code> to <code>"warn"</code>:</p><pre>lgr::get_logger("mlr3")$set_threshold("warn")
</pre>
    <p>To get additional log output for debugging, increase the log level to <code>"debug"</code>
or <code>"trace"</code>:</p><pre>lgr::get_logger("mlr3")$set_threshold("debug")
</pre>
    <p>To log to a file or a data base, see the documentation of <a href='https://www.rdocumentation.org/packages/lgr/topics/lgr-package'>lgr::lgr-package</a>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># benchmarking with benchmark_grid()</span>
<span class='no'>tasks</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>lapply</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"iris"</span>, <span class='st'>"sonar"</span>), <span class='no'>tsk</span>)
<span class='no'>learners</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>lapply</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"classif.featureless"</span>, <span class='st'>"classif.rpart"</span>), <span class='no'>lrn</span>)
<span class='no'>resamplings</span> <span class='kw'>=</span> <span class='fu'><a href='mlr_sugar.html'>rsmp</a></span>(<span class='st'>"cv"</span>, <span class='kw'>folds</span> <span class='kw'>=</span> <span class='fl'>3</span>)

<span class='no'>design</span> <span class='kw'>=</span> <span class='fu'><a href='benchmark_grid.html'>benchmark_grid</a></span>(<span class='no'>tasks</span>, <span class='no'>learners</span>, <span class='no'>resamplings</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>design</span>)</div><div class='output co'>#&gt;             task                     learner     resampling
#&gt; 1: &lt;TaskClassif&gt; &lt;LearnerClassifFeatureless&gt; &lt;ResamplingCV&gt;
#&gt; 2: &lt;TaskClassif&gt;       &lt;LearnerClassifRpart&gt; &lt;ResamplingCV&gt;
#&gt; 3: &lt;TaskClassif&gt; &lt;LearnerClassifFeatureless&gt; &lt;ResamplingCV&gt;
#&gt; 4: &lt;TaskClassif&gt;       &lt;LearnerClassifRpart&gt; &lt;ResamplingCV&gt;</div><div class='input'>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>123</span>)
<span class='no'>bmr</span> <span class='kw'>=</span> <span class='fu'>benchmark</span>(<span class='no'>design</span>)

<span class='co'>## data of all resamplings</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/head'>head</a></span>(<span class='fu'><a href='as.data.table.html'>as.data.table</a></span>(<span class='no'>bmr</span>))</div><div class='output co'>#&gt;                hash          task                     learner     resampling
#&gt; 1: aae8016fbaf188fe &lt;TaskClassif&gt; &lt;LearnerClassifFeatureless&gt; &lt;ResamplingCV&gt;
#&gt; 2: aae8016fbaf188fe &lt;TaskClassif&gt; &lt;LearnerClassifFeatureless&gt; &lt;ResamplingCV&gt;
#&gt; 3: aae8016fbaf188fe &lt;TaskClassif&gt; &lt;LearnerClassifFeatureless&gt; &lt;ResamplingCV&gt;
#&gt; 4: c45243215d4b17b4 &lt;TaskClassif&gt;       &lt;LearnerClassifRpart&gt; &lt;ResamplingCV&gt;
#&gt; 5: c45243215d4b17b4 &lt;TaskClassif&gt;       &lt;LearnerClassifRpart&gt; &lt;ResamplingCV&gt;
#&gt; 6: c45243215d4b17b4 &lt;TaskClassif&gt;       &lt;LearnerClassifRpart&gt; &lt;ResamplingCV&gt;
#&gt;    iteration          prediction
#&gt; 1:         1 &lt;PredictionClassif&gt;
#&gt; 2:         2 &lt;PredictionClassif&gt;
#&gt; 3:         3 &lt;PredictionClassif&gt;
#&gt; 4:         1 &lt;PredictionClassif&gt;
#&gt; 5:         2 &lt;PredictionClassif&gt;
#&gt; 6:         3 &lt;PredictionClassif&gt;</div><div class='input'>
<span class='co'>## aggregated performance values</span>
<span class='no'>aggr</span> <span class='kw'>=</span> <span class='no'>bmr</span>$<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/aggregate'>aggregate</a></span>()
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>aggr</span>)</div><div class='output co'>#&gt;    nr  resample_result task_id          learner_id resampling_id classif.ce
#&gt; 1:  1 &lt;ResampleResult&gt;    iris classif.featureless            cv  0.7000000
#&gt; 2:  2 &lt;ResampleResult&gt;    iris       classif.rpart            cv  0.0600000
#&gt; 3:  3 &lt;ResampleResult&gt;   sonar classif.featureless            cv  0.4661836
#&gt; 4:  4 &lt;ResampleResult&gt;   sonar       classif.rpart            cv  0.2643202</div><div class='input'>
<span class='co'>## Extract predictions of first resampling result</span>
<span class='no'>rr</span> <span class='kw'>=</span> <span class='no'>aggr</span>$<span class='no'>resample_result</span><span class='kw'>[[</span><span class='fl'>1</span>]]
<span class='fu'><a href='as.data.table.html'>as.data.table</a></span>(<span class='no'>rr</span>$<span class='no'>prediction</span>)</div><div class='output co'>#&gt;      row_id     truth   response
#&gt;   1:      1    setosa versicolor
#&gt;   2:      6    setosa versicolor
#&gt;   3:      7    setosa versicolor
#&gt;   4:      9    setosa versicolor
#&gt;   5:     11    setosa versicolor
#&gt;  ---                            
#&gt; 146:    137 virginica  virginica
#&gt; 147:    140 virginica  virginica
#&gt; 148:    143 virginica  virginica
#&gt; 149:    147 virginica  virginica
#&gt; 150:    148 virginica  virginica</div><div class='input'>
<span class='co'># benchmarking with a custom design:</span>
<span class='co'># - fit classif.featureless on iris with a 3-fold CV</span>
<span class='co'># - fit classif.rpart on sonar using a holdout</span>
<span class='no'>tasks</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='fu'><a href='mlr_sugar.html'>tsk</a></span>(<span class='st'>"iris"</span>), <span class='fu'><a href='mlr_sugar.html'>tsk</a></span>(<span class='st'>"sonar"</span>))
<span class='no'>learners</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='fu'><a href='mlr_sugar.html'>lrn</a></span>(<span class='st'>"classif.featureless"</span>), <span class='fu'><a href='mlr_sugar.html'>lrn</a></span>(<span class='st'>"classif.rpart"</span>))
<span class='no'>resamplings</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='fu'><a href='mlr_sugar.html'>rsmp</a></span>(<span class='st'>"cv"</span>, <span class='kw'>folds</span> <span class='kw'>=</span> <span class='fl'>3</span>), <span class='fu'><a href='mlr_sugar.html'>rsmp</a></span>(<span class='st'>"holdout"</span>))

<span class='no'>design</span> <span class='kw'>=</span> <span class='kw pkg'>data.table</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/data.table'>data.table</a></span>(
  <span class='kw'>task</span> <span class='kw'>=</span> <span class='no'>tasks</span>,
  <span class='kw'>learner</span> <span class='kw'>=</span> <span class='no'>learners</span>,
  <span class='kw'>resampling</span> <span class='kw'>=</span> <span class='no'>resamplings</span>
)

<span class='co'>## instantiate resamplings</span>
<span class='no'>design</span>$<span class='no'>resampling</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/funprog'>Map</a></span>(
  <span class='kw'>function</span>(<span class='no'>task</span>, <span class='no'>resampling</span>) <span class='no'>resampling</span>$<span class='fu'>clone</span>()$<span class='fu'>instantiate</span>(<span class='no'>task</span>),
  <span class='kw'>task</span> <span class='kw'>=</span> <span class='no'>design</span>$<span class='no'>task</span>, <span class='kw'>resampling</span> <span class='kw'>=</span> <span class='no'>design</span>$<span class='no'>resampling</span>
)

<span class='co'>## calculate benchmark</span>
<span class='no'>bmr</span> <span class='kw'>=</span> <span class='fu'>benchmark</span>(<span class='no'>design</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>bmr</span>)</div><div class='output co'>#&gt; &lt;BenchmarkResult&gt; of 4 rows with 2 resampling runs
#&gt;  nr task_id          learner_id resampling_id warnings errors classif.ce
#&gt;   1    iris classif.featureless            cv        0      0      0.700
#&gt;   2   sonar       classif.rpart       holdout        0      0      0.333</div><div class='input'>
<span class='co'>## get the training set of the 2nd iteration of the featureless learner on iris</span>
<span class='no'>rr</span> <span class='kw'>=</span> <span class='no'>bmr</span>$<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/aggregate'>aggregate</a></span>()[<span class='no'>learner_id</span> <span class='kw'>==</span> <span class='st'>"classif.featureless"</span>]$<span class='no'>resample_result</span><span class='kw'>[[</span><span class='fl'>1</span>]]
<span class='no'>rr</span>$<span class='no'>resampling</span>$<span class='fu'>train_set</span>(<span class='fl'>2</span>)</div><div class='output co'>#&gt;   [1]   2   3   7  14  17  18  20  22  32  37  40  43  44  45  47  50  53  56
#&gt;  [19]  57  63  67  69  71  72  73  76  79  81  83  84  85  88  92  95  97 113
#&gt;  [37] 114 115 120 127 130 131 137 138 140 141 142 143 149 150   6   8  11  12
#&gt;  [55]  15  16  19  23  24  28  29  33  34  38  39  42  49  51  58  59  61  62
#&gt;  [73]  64  65  66  68  74  77  78  82  87  90  93  99 101 104 105 108 111 112
#&gt;  [91] 119 121 124 128 129 133 135 144 145 146</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#parallelization">Parallelization</a></li>

      <li><a href="#logging">Logging</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <!--<div class="copyright">
  <p>Developed by Michel Lang, Bernd Bischl, Jakob Richter, Patrick Schratz, Martin Binder.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>
-->
      </footer>
   </div>

   

  </body>
</html>

